# 🎮 게임 디자인 개선 완료 요약

## ✅ 적용된 개선사항

### 1️⃣ Nathan의 증거 보고 수정 ✅
**파일**: `static/data/chatbot/case_files/nathan_hale_script.json`

#### Before → After

**Leonard (위조 티켓)**
```diff
- "역무 시스템에 접근할 수 있는 자의 소행으로 보입니다."
+ "하지만 기록을 확인한 결과, 그날 11:50분 열차는 운행되지 않았습니다. 
+  이 티켓의 출처를 밝혀야 할 것 같습니다."
```

**Walter (발자국)**
```diff
- "이 구역에 익숙한 자의 흔적입니다."
+ "발자국에는 기계 오일이 묻어 있었습니다. 
+  이 지역은 일반인 출입이 제한된 구역입니다."
```

**Clara (가위)**
```diff
- "매우 신중한 범인의 소행입니다."
+ "가위에서 지문은 검출되지 않았습니다. 
+  의료 종사자들이 자주 사용하는 종류입니다."
```

**효과**: 
- ✅ Nathan은 이제 사실만 전달
- ✅ 범인 해석은 플레이어가 직접 수행
- ✅ 난이도 상승, 추리 재미 증가

---

### 2️⃣ 프롬프트 강화 ✅
**파일**: `services/chatbot_service.py`

#### 추가된 행동 규칙
```python
### 너의 태도 (Attitude) - 절대 규칙
- 탐정의 질문에 **최소한의 정보만** 제공하라. 질문받은 것만 답하라.
- "도움이 되나요?", "더 알려드릴까요?" 같은 협조적인 질문을 **절대 하지 마라**.
- 불리한 질문에는 짜증, 불안, 경계심을 드러내라.
- 만약 네가 범인이라면: 거짓말한 내용을 기억하고 일관성 있게 유지하되, 
  구체적인 질문에는 회피적으로 답하라.
```

**효과**:
- ✅ 용의자가 자발적으로 정보 제공하지 않음
- ✅ 방어적이고 경계하는 태도 강화
- ✅ 범인의 거짓말이 더 자연스럽게 유지됨

---

### 3️⃣ 추천 질문 재설계 ✅
**파일**: 
- `static/data/chatbot/chardb_text/leonard_graves/knowledge.json`
- `static/data/chatbot/chardb_text/clara_hwang/knowledge.json`
- `static/data/chatbot/chardb_text/walter_briggs/knowledge.json`

#### Leonard Graves 추천 질문

| Before ❌ | After ✅ |
|----------|---------|
| "만약 이 역을 지키기 위해 누군가를 막아야 했다면… 정당한가?" | "그날 밤 몇 시에 역에 계셨나요?" |
| "역을 사랑하신다고... 기사 이후 평판이 바뀌었죠?" | "11시 50분쯤 어디에 계셨나요?" |
| "보관창고 열쇠는 항상 본인이?" | "보관창고는 어떤 용도로 사용되나요?" |

**새로운 질문들**:
1. "그날 밤 몇 시에 역에 계셨나요?" (시간 확인)
2. "야간 근무 중 주로 어떤 일을 하시나요?" (배경 탐색)
3. "역 조명은 몇 시에 소등하나요?" (사실 확인)
4. "11시 50분쯤 어디에 계셨나요?" (알리바이)
5. "역무실 시스템에 접근할 수 있는 사람은 누구인가요?" (증거 연결)

#### Clara Hwang 추천 질문

| Before ❌ | After ✅ |
|----------|---------|
| "그 기자가 당신 사진을 올린 일… 아직도 마음에?" | "그날 밤 몇 시에 역에 계셨나요?" |
| "Elias 씨랑 예전에 기사 문제로 알던 사이였죠?" | "그날 밤 11시 30분 막차를 타셨나요?" |
| "요즘 야간 근무 때 어떤 도구들 챙겨요?" | "가방에는 주로 무엇을 넣고 다니시나요?" |

**새로운 질문들**:
1. "그날 밤 몇 시에 역에 계셨나요?" (시간 확인)
2. "병원 근무는 몇 시에 끝나나요?" (배경 탐색)
3. "그날 밤 11시 30분 막차를 타셨나요?" (알리바이)
4. "막차를 놓치신 적은 없으신가요?" (모순 유도)
5. "가방에는 주로 무엇을 넣고 다니시나요?" (증거 연결)

#### Walter Briggs 추천 질문

| Before ❌ | After ✅ |
|----------|---------|
| "피해자와 언쟁을 벌이셨다는 목격이 있습니다" | "그날 밤 몇 시에 역에 계셨나요?" |
| "기자가 당신 이야기를 기사로 쓴 걸 알고 계셨나요?" | "11시 50분쯤 어디에 계셨나요?" |
| "구두에 묻은 기름은 어디서?" | "전력 장치 구역에 대해 알고 계신가요?" |

**새로운 질문들**:
1. "그날 밤 몇 시에 역에 계셨나요?" (시간 확인)
2. "기관사 시절 이 역에서 근무하셨나요?" (배경 탐색)
3. "11시 50분쯤 어디에 계셨나요?" (알리바이)
4. "전력 장치 구역에 대해 알고 계신가요?" (증거 연결)
5. "막차가 떠난 후에도 역에 계셨나요?" (모순 유도)

**효과**:
- ✅ 범인 동기를 직접 암시하지 않음
- ✅ 중립적이고 자연스러운 질문
- ✅ 교차 검증 가능한 시간대별 질문
- ✅ 증거와 연결되는 사실 확인 질문

---

## 🎯 게임 플레이 변화

### Before (개선 전)
```
1. Nathan: "역무 시스템에 접근할 수 있는 자의 소행" 
   → 너무 쉽게 Leonard 특정

2. 추천 질문: "역을 지키기 위해 막아야 했다면 정당한가?"
   → Leonard가 범인일 때 동기를 대놓고 암시

3. 용의자: "제가 도와드릴 게 더 있나요?"
   → 협조적이고 친절함
```
**결과**: 범인 찾기가 너무 쉬움 😴

### After (개선 후)
```
1. Nathan: "11:50분 열차는 운행되지 않았습니다. 티켓의 출처를 밝혀야..."
   → 사실만 제공, 플레이어가 직접 추리

2. 추천 질문: "11시 50분쯤 어디에 계셨나요?"
   → 중립적, 3명 모두에게 공통적으로 물어볼 수 있음

3. 용의자: (불리한 질문에) "그게 무슨 상관이죠?"
   → 방어적이고 경계하는 태도
```
**결과**: 교차 검증하며 모순 발견해야 함 🔍

---

## 📊 개선 효과 요약

| 항목 | Before | After |
|------|--------|-------|
| **증거 해석** | Nathan이 직접 제공 | 플레이어가 추리 |
| **추천 질문** | 범인 동기 암시 | 중립적 사실 확인 |
| **용의자 태도** | 협조적 | 방어적 |
| **난이도** | ⭐⭐ (쉬움) | ⭐⭐⭐⭐ (적절) |
| **추리 재미** | 낮음 | 높음 |
| **모순 발견** | 불필요 | 필수 |

---

## 🚀 테스트 방법

### 1. Docker 재시작
```bash
docker compose down
docker compose up --build
```

### 2. 테스트 시나리오

#### 시나리오 A: Leonard가 범인일 때
```
1. Leonard에게 "11시 50분쯤 어디 계셨나요?" 질문
   → 모호한 답변 (역 주변 점검...)

2. Walter에게 "그때 역무실 불이 켜져 있었나요?" 질문
   → "아니, 어두웠소"

3. 모순 발견! Leonard의 위치가 불명확
   
4. Nathan의 증거: 11:50분 티켓 (운행 안 함)
   → Leonard만 티켓 발행 가능

5. 재질문: "역무 시스템으로 과거 티켓 인쇄 가능한가요?"
   → 방어적 반응
```

#### 시나리오 B: 3명 교차 검증
```
공통 질문을 모두에게:
- "11시 30분 막차 때 어디 계셨나요?"
- "11시 50분쯤은요?"
- "자정 무렵엔?"

→ 진술 비교하여 모순 찾기
```

---

## 📚 추가 개선 가능 항목 (향후)

### Phase 4: 교차 검증 시스템 (선택)
- [ ] `contradiction_points` 섹션 추가
- [ ] 대화 이력 기반 모순 자동 감지
- [ ] "아까 OO라고 하셨는데..." 식의 재추궁 가능

### Phase 5: 힌트 시스템 (선택)
- [ ] 플레이어가 막힐 경우 Nathan이 미묘한 힌트 제공
- [ ] "두 사람의 진술을 비교해보시오" 같은 가이드

---

## 🎮 최종 평가

### ✅ 달성된 목표
1. ✅ Nathan의 증거가 해석이 아닌 사실만 전달
2. ✅ 추천 질문이 범인을 암시하지 않음
3. ✅ 용의자가 방어적이고 최소 정보만 제공
4. ✅ 교차 검증을 통한 모순 발견이 핵심이 됨

### 🎯 기대 효과
- 추리 게임으로서의 재미 증가
- 플레이어의 능동적 사고 유도
- 반복 플레이 가능성 향상
- 범인이 바뀌어도 자연스러움

---

## 💡 플레이 팁 (플레이어에게)

1. **모든 용의자에게 같은 질문을 해보세요**
   - "11시 50분에 어디 계셨나요?"를 3명 모두에게

2. **시간대별로 정리하세요**
   - 11:30 → 11:40 → 11:50 → 자정
   - 각자의 진술을 타임라인에 매핑

3. **증거와 진술을 연결하세요**
   - 티켓 → 누가 발행 가능?
   - 발자국 → 누가 그 구역 접근 가능?
   - 가위 → 누가 소지 가능?

4. **모순을 찾으세요**
   - A는 "B를 봤다" vs B는 "거기 없었다"
   - 이런 엇갈림이 핵심!

---

## 📝 개발 노트

이번 개선으로 게임이 "찍기 게임"에서 "추리 게임"으로 전환되었습니다.

**핵심 철학**:
- "Show, don't tell" - 증거를 보여주되, 해석은 하지 않음
- "Trust the player" - 플레이어가 충분히 추리할 수 있다고 믿음
- "Let them work for it" - 쉽게 주지 않고 노력하게 만듦

결과적으로 게임의 만족도와 재플레이 가치가 크게 상승할 것으로 기대됩니다! 🎉

