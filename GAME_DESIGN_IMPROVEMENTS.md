# 🎮 게임 디자인 개선 방안

## 📌 현재 문제점

### 1. 중간 증거가 너무 직접적
```
❌ "역무 시스템에 접근할 수 있는 자의 소행으로 보입니다."
❌ "이 구역에 익숙한 자의 흔적입니다."
❌ "매우 신중한 범인의 소행입니다."
```
→ Nathan이 해석까지 제공하여 범인을 너무 쉽게 특정 가능

### 2. 추천 질문이 범인을 암시
```
❌ "퇴직과 관련해서 억울한 점이 있나요?" (Leonard가 범인일 때의 동기를 암시)
❌ "과거 사고에 대한 원한이 있나요?" (Walter가 범인일 때의 동기를 암시)
```
→ 범인이 아니어도 범인처럼 보이게 만듦

### 3. 모순 발견의 어려움
- 사용자가 진술 간 모순을 스스로 발견하기 어려움
- 교차 검증할 수 있는 질문 구조가 부족

---

## 💡 해결 방안

### 방안 1: Nathan의 증거 제공 방식 변경

#### ✅ Before → After

**Leonard (위조 티켓 증거)**
```diff
- "피해자의 주머니에서 위조된 '11:50분 막차' 티켓이 발견되었습니다. 
-  역무 시스템에 접근할 수 있는 자의 소행으로 보입니다."

+ "피해자의 주머니에서 '11:50분 막차' 티켓이 발견되었습니다.
+  하지만 기록을 확인한 결과, 그날 11:50분 열차는 운행되지 않았습니다.
+  이 티켓의 출처를 밝혀야 할 것 같습니다."
```

**Walter (발자국 증거)**
```diff
- "피해자가 추락한 전력 장치 구역 근처에서 기름 묻은 작업화 발자국이 발견되었습니다.
-  이 구역에 익숙한 자의 흔적입니다."

+ "피해자가 발견된 전력 장치 구역 근처에서 작업화 발자국이 발견되었습니다.
+  발자국에는 기계 오일이 묻어 있었습니다.
+  이 지역은 일반인 출입이 제한된 구역입니다."
```

**Clara (가위 증거)**
```diff
- "범행에 사용된 것으로 보이는 가위가 발견되었습니다.
-  하지만 지문이 깨끗하게 닦여 있었습니다. 매우 신중한 범인의 소행입니다."

+ "피해자의 상처와 일치하는 의료용 가위가 발견되었습니다.
+  가위에서 지문은 검출되지 않았습니다.
+  의료 종사자들이 자주 사용하는 종류입니다."
```

**핵심 원칙:**
- ✅ 사실(Fact)만 전달
- ❌ 해석(Interpretation) 제공 금지
- ✅ "이것이 무엇을 의미하는지는 당신이 판단하시오" 톤 유지

---

### 방안 2: 추천 질문 시스템 재설계

#### 🎯 새로운 추천 질문 구조

**A. 공통 질문 (모든 용의자에게 공통)**
```json
"common_questions": [
  "그날 밤 몇 시에 역에 계셨나요?",
  "11시 50분쯤 어디에 계셨나요?",
  "피해자 Elias Cole을 본 적이 있나요?",
  "역에서 수상한 사람을 목격했나요?",
  "그날 밤 다른 사람과 대화하셨나요?"
]
```

**B. 배경 질문 (용의자별 직업/배경 탐색)**
```json
"leonard": [
  "야간 근무 중 주로 어떤 일을 하시나요?",
  "역무실 시스템에 대해 설명해주세요",
  "그날 밤 정전이 있었나요?",
  "막차 시간은 언제인가요?"
],
"walter": [
  "역 주변에서 주로 어디에 계시나요?",
  "전력 장치 구역에 들어가본 적이 있나요?",
  "과거 기관사 시절 이야기를 들려주세요",
  "그날 밤 역 안에 누가 있었나요?"
],
"clara": [
  "병원에서는 어떤 일을 하시나요?",
  "매일 막차를 타고 가시나요?",
  "그날 밤 기차를 탔나요?",
  "대합실에서 누군가를 봤나요?"
]
```

**C. 교차 검증 질문 (시간대별 알리바이)**
```json
"timeline_questions": [
  "11시 30분에는 어디 계셨죠?",
  "11시 40분에는 무엇을 하고 계셨나요?",
  "11시 50분쯤 누구와 함께 있었나요?",
  "자정 무렵에는 어디에 계셨나요?"
]
```

**핵심 원칙:**
- ✅ 범인 동기를 직접 암시하지 않음
- ✅ 시간대별 알리바이를 교차 검증 가능하게
- ✅ 배경/직업에 자연스럽게 질문
- ✅ 3명의 진술을 비교하여 모순 발견 유도

---

### 방안 3: Knowledge.json 구조 개선

#### 🔍 현재 문제점
```json
// 너무 추상적
{
  "keywords": ["알리바이", "11시"],
  "fact_innocent": "저는 역무실에 있었습니다.",
  "fact_killer": "저는... 역 주변을 순찰하고 있었습니다."
}
```

#### ✅ 개선된 구조
```json
{
  "id": "leonard_timeline_11_50",
  "keywords": ["11시 50분", "11시 반", "자정 전", "시간"],
  "fact_innocent": "11시 50분에는 역무실에서 폐쇄 절차를 진행하고 있었습니다. CCTV 기록이 있을 겁니다.",
  "fact_killer": "11시 50분... 역 주변을 최종 점검하고 있었습니다. 혼자였죠.",
  "lie_behavior": "구체적인 장소를 회피하고, 증명할 수 없는 '순찰' 같은 모호한 표현 사용"
}
```

**새로운 섹션 추가:**
```json
"contradiction_points": [
  {
    "topic": "막차 시간",
    "leonard_says": "막차는 11시 30분입니다.",
    "walter_says": "11시 반 막차는 탔는데...",
    "clara_says": "11시 30분 막차를 놓쳤어요.",
    "truth": "막차는 11시 30분이 맞음",
    "killer_contradiction": {
      "leonard": "만약 Leonard가 범인이면 '11시 50분 티켓'을 위조한 이유 설명 필요",
      "walter": "자신이 11시 30분 막차를 탔다면 역에 왜 있었는지 설명 불가",
      "clara": "막차를 놓쳤다면 어떻게 귀가했는지 불명확"
    }
  }
]
```

---

### 방안 4: 프롬프팅 개선

#### ✅ 용의자 답변 원칙 강화

**현재 프롬프트에 추가할 지침:**
```
### 추가 행동 원칙 (CRITICAL)
1. **최소 정보 원칙**: 
   - 질문받은 것만 답하고, 추가 정보는 절대 자발적으로 제공하지 마라
   - "도움이 되나요?", "더 알려드릴까요?" 같은 협조적 표현 금지

2. **모순 유지 원칙** (범인인 경우):
   - 거짓말한 내용을 기억하고 일관성 있게 유지하라
   - 다른 용의자의 진술과 미묘하게 엇갈리게 답하라
   - 시간대별 알리바이에서 구멍이 보이도록 하되, 자연스럽게 회피하라

3. **방어적 태도**:
   - 당신은 협조자가 아니라 용의자다
   - 탐정의 질문에 경계심을 보여라
   - 불리한 질문에는 짜증이나 불안을 드러내라
```

---

## 🎯 최종 게임 플로우

```
1. 초기 브리핑 (Nathan)
   └─ 사건 개요만 전달, 해석 없음

2. 용의자 심문 (User)
   ├─ 공통 질문으로 기본 정보 수집
   ├─ 배경 질문으로 각자의 이야기 청취
   └─ 시간대별 알리바이 교차 검증

3. 중간 보고 (Nathan)
   └─ 증거 제시만, 해석은 탐정이 직접

4. 재심문 (User)
   ├─ 증거를 바탕으로 모순 추궁
   ├─ 3명의 진술 비교
   └─ 거짓말하는 자 식별

5. 범인 지목
   └─ 모순과 증거를 종합하여 결정
```

---

## 📝 구현 체크리스트

### Phase 1: 증거 보고 수정
- [ ] `nathan_hale_script.json` 수정
  - [ ] Leonard 증거 텍스트 변경
  - [ ] Walter 증거 텍스트 변경
  - [ ] Clara 증거 텍스트 변경
  - [ ] 해석 제거, 사실만 전달

### Phase 2: 추천 질문 재설계
- [ ] `knowledge.json` 각 용의자별 수정
  - [ ] `common_questions` 섹션 추가
  - [ ] `background_questions` 섹션 추가
  - [ ] `timeline_questions` 섹션 추가
  - [ ] 기존 `recommended_questions` 검토 및 수정

### Phase 3: 교차 검증 시스템
- [ ] `contradiction_points` 섹션 설계
- [ ] 시간대별 알리바이 매핑 테이블 작성
- [ ] 3명의 진술이 서로 엇갈리는 지점 명확화

### Phase 4: 프롬프트 강화
- [ ] `chatbot_service.py` 프롬프트 수정
  - [ ] "최소 정보 원칙" 추가
  - [ ] "모순 유지 원칙" 추가
  - [ ] "방어적 태도" 강화

---

## 🎨 예시: Leonard가 범인일 때 vs 무죄일 때

### 질문: "11시 50분에 어디 계셨나요?"

**Leonard (무죄일 때)**
```
"11시 50분이요? 역무실에서 폐쇄 절차를 진행하고 있었습니다. 
매일 하는 일이라 확실합니다. CCTV도 있을 겁니다."
```
→ 구체적, 증명 가능, 확신에 참

**Leonard (범인일 때)**
```
"11시 50분... 역 주변을 최종 점검하고 있었습니다. 
야간 근무자로서 당연한 일이죠."
```
→ 모호함, 증명 불가, "당연한 일"로 회피

### 교차 검증

**Walter의 증언**
```
"11시 50분쯤 역무실 불이 꺼져 있는 걸 봤습니다."
```

**모순 발견!**
- Leonard(범인): "역 주변 점검 중" + Walter: "역무실 불 꺼짐" = 일치
- Leonard(무죄): "역무실에 있었음" + Walter: "역무실 불 꺼짐" = **모순!**

→ 사용자가 이런 모순을 발견하도록 유도

---

## 🚀 권장 적용 순서

1. **먼저**: Nathan 증거 텍스트만 수정 (가장 간단)
2. **그 다음**: 추천 질문 재구성 (시간 소요)
3. **마지막**: knowledge.json 교차 검증 시스템 (가장 복잡)

---

## 💡 추가 아이디어

### A. 거짓말 탐지 힌트
```
Leonard가 거짓말할 때:
- 말을 더듬거나 "..."를 많이 사용
- "당연히", "분명히" 같은 과도한 확신 표현
- 구체적 질문에 회피적 답변
```

### B. 감정 이미지 활용
```
진실을 말할 때: 중립, 약간 긴장
거짓말할 때: 분노, 심한 긴장, 불안
```

### C. 대화 이력 기반 모순 지적
```
User: "아까 11시 50분에 역무실에 있었다고 하셨는데,
       Walter는 그때 역무실 불이 꺼져있었다고 합니다."
Leonard (범인): "...제가 잠깐 나갔을 수도 있죠."
```

